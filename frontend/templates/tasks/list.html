<html>
<head>
{% load static %}
<link rel="stylesheet" href="{% get_static_prefix %}style.css" />
<script type="text/javascript" src="{% get_static_prefix %}js/jquery.min.js"></script>
<script type="text/javascript" src="{% get_static_prefix %}js/list.js"></script>
</head>
<body>
<form action="add_task/" method="post">
    {% csrf_token %}
    <input type="text" name="new_task_name" maxlength="255" placeholder="nazwa zadania" size="60" autofocus="autofocus" />
    <input type="submit" value="Dodaj zadanie" />
    <input type="text" name="priority" maxlength="3" placeholder="priorytet" size="2" value="0" />
</form>

<hr />

{% if lista %}
<ol>
    {% for task in lista %}
    <li>
    <div id="task_{{ task.id }}_container" class="task_div">
        <button
            type="button"
            id="del_task_{{ task.id }}"
            task-id="{{ task.id }}"
            class="delete_button"
            title="usuń (wraz z podpunktami)"></button>
    {% if task.is_open %}
        <button
            type="button"
            id="task_{{ task.id }}"
            task-id="{{ task.id }}"
            class="tick_button"
            title="skreśl"></button>
        <span class="priority">({{ task.priority }}) </span><span class="task_name">{{ task }}</span>
        <div class="task_form" style="display: inline;">
            <input type="text" id="subtask_name_{{ task.id }}" placeholder="dodaj podpunkt" maxlength="255" size="50" />
            <button
                type="button"
                id="add_task_{{ task.id }}"
                task-id="{{ task.id }}"
                class="add_button" ></button>
        </div>
    {% else %}
        <button
            type="button"
            id="task_{{ task.id }}"
            task-id="{{ task.id }}"
            class="revive_button"
            title="odkreśl"></button>
        <span class="priority">({{ task.priority }}) </span><span class="cross_gray">{{ task }}</span>
    {% endif %}
    </div>
    <div class="subtasks_container">
        {% for subtask in task.subtask_set.all %}
        <div id="subtask_{{ subtask.id }}_container" class="subtask_div">
            <button
                type="button"
                id="del_subtask_{{ subtask.id }}"
                subtask-id="{{ subtask.id }}"
                class="delete_sub_button"
                title="skreśl"></button>
            <button
                type="button"
                id="subtask_{{ subtask.id }}"
                subtask-id="{{ subtask.id }}"
                class="{% if subtask.is_open %}cross_sub_button{% else %}revive_sub_button{% endif %}"
                title="skreśl"></button>
            <span {% if not subtask.is_open %}class="cross_gray"{% endif %}>{{ subtask }}</span>
        </div>
        {% endfor %}
    </div>
    </li>
    {% endfor %}
</ol>
{% else %}
<p>Nie ma zadań</p>
{% endif %}
</body>
</html>
